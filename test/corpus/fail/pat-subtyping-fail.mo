=========
pat-subtyping-fail.mo
=========

func magic() : None = magic();

switch (magic () : Nat) {
  case (-1) {};  // redundant
  case _ {};
};
switch (magic () : Nat) {
  case (-1 : Int) {};  // redundant
  case _ {};
};

switch (magic () : (Nat, Nat)) {
  case ((1, -2) : (Int, Int)) {};  // redundant
  case _ {};
};
switch (magic () : (Nat, Nat)) {
  case (1 : Int, -2 : Int) {};  // redundant
  case _ {};
};

switch (magic () : {a : Nat; b : Nat}) {
  case ({a = 1; b = -2} : {a : Int; b : Int}) {};  // redundant
  case _ {};
};
switch (magic () : {a : Nat; b : Nat}) {
  case {a = 1 : Int; b = -2 : Int} {};  // redundant
  case _ {};
};

switch (magic () : ?Nat) {
  case (? -1) {};  // redundant
  case _ {};
};
switch (magic () : ?Nat) {
  case (? -1 : ?Int) {};  // redundant
  case _ {};
};
switch (magic () : ?Nat) {
  case (?(-1 : Int)) {};  // redundant
  case _ {};
};

switch (magic () : {#A : Nat; #B}) {
  case (#A(-1)) {};  // redundant
  case _ {};
};
switch (magic () : {#A : Nat; #B}) {
  case (#A(-1 : Int)) {};  // redundant
  case _ {};
};
switch (magic () : {#A : Nat; #B}) {
  case (#A(-1) : {#A : Int; #B}) {};  // redundant
  case _ {};
};

switch (magic () : Int) {
  case (n : Nat) {};
};

switch (magic () : (Int, Int)) {
  case (p : (Nat, Nat)) {};
};
switch (magic () : (Int, Int)) {
  case ((x, y) : (Nat, Nat)) {};
};
switch (magic () : (Int, Int)) {
  case (x : Nat, y : Nat) {};
};

switch (magic () : {a : Int; b : Int}) {
  case (r : {a : Nat; b : Nat}) {};
};
switch (magic () : {a : Int; b : Int}) {
  case ({a; b} : {a : Nat; b : Nat}) {};
};
switch (magic () : {a : Int; b : Int}) {
  case {a = _ : Nat; b = _ : Nat} {};
};
switch (magic () : {a : Nat}) {
  case (r : {a : Nat; b : Nat}) {};
};
switch (magic () : {a : Nat}) {
  case ({a; b} : {a : Nat; b : Nat}) {};
};
switch (magic () : {}) {
  case (r : {a : Nat; b : Nat}) {};
};
switch (magic () : {}) {
  case ({a; b} : {a : Nat; b : Nat}) {};
};

switch (magic () : Null) {
  case (null) {};
  case (? _) {};
};
switch (magic () : ?Nat) {
  case (null : Null) {};
  case _ {};
};
switch (magic () : ?Int) {
  case (?n : ?Nat) {};
  case null {};
};
switch (magic () : ?Int) {
  case (?(_ : Nat)) {};
  case _ {};
};

switch (magic () : {#}) {
  case (#A _ : {#A : Nat; #B}) {};  // redundant
};
switch (magic () : {#A : Nat; #B}) {
  case (#A _ : {#A : Nat}) {};
  case _ {};
};
switch (magic () : {#A : Nat; #B}) {
  case (#B : {#B}) {};
  case _ {};
};


switch (magic ()) {
  case true {};
  case 1 {};
};


do {
  func f(x : Int : Nat) {};  // ok
};
do {
  func f(x : Nat : Int) {};
};
do {
  func f(x : Nat : Int : Nat) {};
};
do {
  func f(x : Int : Nat : Int) {};
};
do {
  ignore (func(x : Int) {}) : (Nat -> ());  // ok
};
do {
  ignore (func(x : Nat) {}) : (Int -> ());
};
do {
  ignore (func(x : Nat : Int) {}) : (Nat -> ());
};
do {
  ignore (func(x : Int : Nat) {}) : (Int -> ());
};
do {
  ignore (func f(x : Int) {}) : (Nat -> ());  // ok
};
do {
  ignore (func f(x : Nat) {}) : (Int -> ());
};
do {
  ignore (func f(x : Nat : Int) {}) : (Nat -> ());
};
do {
  ignore (func f(x : Int : Nat) {}) : (Int -> ());
};

---

(source_file
  (func_dec
    (identifier)
    (tup_pat)
    (typ_annot
      (path_typ
        (typ_path
          (type_identifier))))
    (func_body
      (call_exp_object
        (var_exp
          (identifier))
        (par_exp))))
  (exp_dec
    (switch_exp
      (par_exp
        (annot_exp_object
          (call_exp_object
            (var_exp
              (identifier))
            (par_exp))
          (path_typ
            (typ_path
              (type_identifier)))))
      (case
        (tup_pat
          (lit_pat
            (int_literal)))
        (block_exp))
      (line_comment)
      (case
        (wild_pat)
        (block_exp))))
  (exp_dec
    (switch_exp
      (par_exp
        (annot_exp_object
          (call_exp_object
            (var_exp
              (identifier))
            (par_exp))
          (path_typ
            (typ_path
              (type_identifier)))))
      (case
        (tup_pat
          (annot_pat
            (lit_pat
              (int_literal))
            (typ_annot
              (path_typ
                (typ_path
                  (type_identifier))))))
        (block_exp))
      (line_comment)
      (case
        (wild_pat)
        (block_exp))))
  (exp_dec
    (switch_exp
      (par_exp
        (annot_exp_object
          (call_exp_object
            (var_exp
              (identifier))
            (par_exp))
          (tup_typ
            (typ_item
              (path_typ
                (typ_path
                  (type_identifier))))
            (typ_item
              (path_typ
                (typ_path
                  (type_identifier)))))))
      (case
        (tup_pat
          (annot_pat
            (tup_pat
              (lit_pat
                (int_literal))
              (lit_pat
                (int_literal)))
            (typ_annot
              (tup_typ
                (typ_item
                  (path_typ
                    (typ_path
                      (type_identifier))))
                (typ_item
                  (path_typ
                    (typ_path
                      (type_identifier))))))))
        (block_exp))
      (line_comment)
      (case
        (wild_pat)
        (block_exp))))
  (exp_dec
    (switch_exp
      (par_exp
        (annot_exp_object
          (call_exp_object
            (var_exp
              (identifier))
            (par_exp))
          (tup_typ
            (typ_item
              (path_typ
                (typ_path
                  (type_identifier))))
            (typ_item
              (path_typ
                (typ_path
                  (type_identifier)))))))
      (case
        (tup_pat
          (annot_pat
            (lit_pat
              (int_literal))
            (typ_annot
              (path_typ
                (typ_path
                  (type_identifier)))))
          (annot_pat
            (lit_pat
              (int_literal))
            (typ_annot
              (path_typ
                (typ_path
                  (type_identifier))))))
        (block_exp))
      (line_comment)
      (case
        (wild_pat)
        (block_exp))))
  (exp_dec
    (switch_exp
      (par_exp
        (annot_exp_object
          (call_exp_object
            (var_exp
              (identifier))
            (par_exp))
          (obj_typ
            (val_tf
              (identifier)
              (path_typ
                (typ_path
                  (type_identifier))))
            (val_tf
              (identifier)
              (path_typ
                (typ_path
                  (type_identifier)))))))
      (case
        (tup_pat
          (annot_pat
            (obj_pat
              (pat_field
                (identifier)
                (lit_pat
                  (int_literal)))
              (pat_field
                (identifier)
                (lit_pat
                  (int_literal))))
            (typ_annot
              (obj_typ
                (val_tf
                  (identifier)
                  (path_typ
                    (typ_path
                      (type_identifier))))
                (val_tf
                  (identifier)
                  (path_typ
                    (typ_path
                      (type_identifier))))))))
        (block_exp))
      (line_comment)
      (case
        (wild_pat)
        (block_exp))))
  (exp_dec
    (switch_exp
      (par_exp
        (annot_exp_object
          (call_exp_object
            (var_exp
              (identifier))
            (par_exp))
          (obj_typ
            (val_tf
              (identifier)
              (path_typ
                (typ_path
                  (type_identifier))))
            (val_tf
              (identifier)
              (path_typ
                (typ_path
                  (type_identifier)))))))
      (case
        (obj_pat
          (pat_field
            (identifier)
            (annot_pat
              (lit_pat
                (int_literal))
              (typ_annot
                (path_typ
                  (typ_path
                    (type_identifier))))))
          (pat_field
            (identifier)
            (annot_pat
              (lit_pat
                (int_literal))
              (typ_annot
                (path_typ
                  (typ_path
                    (type_identifier)))))))
        (block_exp))
      (line_comment)
      (case
        (wild_pat)
        (block_exp))))
  (exp_dec
    (switch_exp
      (par_exp
        (annot_exp_object
          (call_exp_object
            (var_exp
              (identifier))
            (par_exp))
          (quest_typ
            (path_typ
              (typ_path
                (type_identifier))))))
      (case
        (tup_pat
          (quest_pat
            (lit_pat
              (int_literal))))
        (block_exp))
      (line_comment)
      (case
        (wild_pat)
        (block_exp))))
  (exp_dec
    (switch_exp
      (par_exp
        (annot_exp_object
          (call_exp_object
            (var_exp
              (identifier))
            (par_exp))
          (quest_typ
            (path_typ
              (typ_path
                (type_identifier))))))
      (case
        (tup_pat
          (annot_pat
            (quest_pat
              (lit_pat
                (int_literal)))
            (typ_annot
              (quest_typ
                (path_typ
                  (typ_path
                    (type_identifier)))))))
        (block_exp))
      (line_comment)
      (case
        (wild_pat)
        (block_exp))))
  (exp_dec
    (switch_exp
      (par_exp
        (annot_exp_object
          (call_exp_object
            (var_exp
              (identifier))
            (par_exp))
          (quest_typ
            (path_typ
              (typ_path
                (type_identifier))))))
      (case
        (tup_pat
          (quest_pat
            (tup_pat
              (annot_pat
                (lit_pat
                  (int_literal))
                (typ_annot
                  (path_typ
                    (typ_path
                      (type_identifier))))))))
        (block_exp))
      (line_comment)
      (case
        (wild_pat)
        (block_exp))))
  (exp_dec
    (switch_exp
      (par_exp
        (annot_exp_object
          (call_exp_object
            (var_exp
              (identifier))
            (par_exp))
          (variant_typ
            (typ_tag
              (identifier)
              (typ_annot
                (path_typ
                  (typ_path
                    (type_identifier)))))
            (typ_tag
              (identifier)))))
      (case
        (tup_pat
          (tag_pat
            (identifier)
            (tup_pat
              (lit_pat
                (int_literal)))))
        (block_exp))
      (line_comment)
      (case
        (wild_pat)
        (block_exp))))
  (exp_dec
    (switch_exp
      (par_exp
        (annot_exp_object
          (call_exp_object
            (var_exp
              (identifier))
            (par_exp))
          (variant_typ
            (typ_tag
              (identifier)
              (typ_annot
                (path_typ
                  (typ_path
                    (type_identifier)))))
            (typ_tag
              (identifier)))))
      (case
        (tup_pat
          (tag_pat
            (identifier)
            (tup_pat
              (annot_pat
                (lit_pat
                  (int_literal))
                (typ_annot
                  (path_typ
                    (typ_path
                      (type_identifier))))))))
        (block_exp))
      (line_comment)
      (case
        (wild_pat)
        (block_exp))))
  (exp_dec
    (switch_exp
      (par_exp
        (annot_exp_object
          (call_exp_object
            (var_exp
              (identifier))
            (par_exp))
          (variant_typ
            (typ_tag
              (identifier)
              (typ_annot
                (path_typ
                  (typ_path
                    (type_identifier)))))
            (typ_tag
              (identifier)))))
      (case
        (tup_pat
          (annot_pat
            (tag_pat
              (identifier)
              (tup_pat
                (lit_pat
                  (int_literal))))
            (typ_annot
              (variant_typ
                (typ_tag
                  (identifier)
                  (typ_annot
                    (path_typ
                      (typ_path
                        (type_identifier)))))
                (typ_tag
                  (identifier))))))
        (block_exp))
      (line_comment)
      (case
        (wild_pat)
        (block_exp))))
  (exp_dec
    (switch_exp
      (par_exp
        (annot_exp_object
          (call_exp_object
            (var_exp
              (identifier))
            (par_exp))
          (path_typ
            (typ_path
              (type_identifier)))))
      (case
        (tup_pat
          (annot_pat
            (var_pat
              (identifier))
            (typ_annot
              (path_typ
                (typ_path
                  (type_identifier))))))
        (block_exp))))
  (exp_dec
    (switch_exp
      (par_exp
        (annot_exp_object
          (call_exp_object
            (var_exp
              (identifier))
            (par_exp))
          (tup_typ
            (typ_item
              (path_typ
                (typ_path
                  (type_identifier))))
            (typ_item
              (path_typ
                (typ_path
                  (type_identifier)))))))
      (case
        (tup_pat
          (annot_pat
            (var_pat
              (identifier))
            (typ_annot
              (tup_typ
                (typ_item
                  (path_typ
                    (typ_path
                      (type_identifier))))
                (typ_item
                  (path_typ
                    (typ_path
                      (type_identifier))))))))
        (block_exp))))
  (exp_dec
    (switch_exp
      (par_exp
        (annot_exp_object
          (call_exp_object
            (var_exp
              (identifier))
            (par_exp))
          (tup_typ
            (typ_item
              (path_typ
                (typ_path
                  (type_identifier))))
            (typ_item
              (path_typ
                (typ_path
                  (type_identifier)))))))
      (case
        (tup_pat
          (annot_pat
            (tup_pat
              (var_pat
                (identifier))
              (var_pat
                (identifier)))
            (typ_annot
              (tup_typ
                (typ_item
                  (path_typ
                    (typ_path
                      (type_identifier))))
                (typ_item
                  (path_typ
                    (typ_path
                      (type_identifier))))))))
        (block_exp))))
  (exp_dec
    (switch_exp
      (par_exp
        (annot_exp_object
          (call_exp_object
            (var_exp
              (identifier))
            (par_exp))
          (tup_typ
            (typ_item
              (path_typ
                (typ_path
                  (type_identifier))))
            (typ_item
              (path_typ
                (typ_path
                  (type_identifier)))))))
      (case
        (tup_pat
          (annot_pat
            (var_pat
              (identifier))
            (typ_annot
              (path_typ
                (typ_path
                  (type_identifier)))))
          (annot_pat
            (var_pat
              (identifier))
            (typ_annot
              (path_typ
                (typ_path
                  (type_identifier))))))
        (block_exp))))
  (exp_dec
    (switch_exp
      (par_exp
        (annot_exp_object
          (call_exp_object
            (var_exp
              (identifier))
            (par_exp))
          (obj_typ
            (val_tf
              (identifier)
              (path_typ
                (typ_path
                  (type_identifier))))
            (val_tf
              (identifier)
              (path_typ
                (typ_path
                  (type_identifier)))))))
      (case
        (tup_pat
          (annot_pat
            (var_pat
              (identifier))
            (typ_annot
              (obj_typ
                (val_tf
                  (identifier)
                  (path_typ
                    (typ_path
                      (type_identifier))))
                (val_tf
                  (identifier)
                  (path_typ
                    (typ_path
                      (type_identifier))))))))
        (block_exp))))
  (exp_dec
    (switch_exp
      (par_exp
        (annot_exp_object
          (call_exp_object
            (var_exp
              (identifier))
            (par_exp))
          (obj_typ
            (val_tf
              (identifier)
              (path_typ
                (typ_path
                  (type_identifier))))
            (val_tf
              (identifier)
              (path_typ
                (typ_path
                  (type_identifier)))))))
      (case
        (tup_pat
          (annot_pat
            (obj_pat
              (pat_field
                (identifier))
              (pat_field
                (identifier)))
            (typ_annot
              (obj_typ
                (val_tf
                  (identifier)
                  (path_typ
                    (typ_path
                      (type_identifier))))
                (val_tf
                  (identifier)
                  (path_typ
                    (typ_path
                      (type_identifier))))))))
        (block_exp))))
  (exp_dec
    (switch_exp
      (par_exp
        (annot_exp_object
          (call_exp_object
            (var_exp
              (identifier))
            (par_exp))
          (obj_typ
            (val_tf
              (identifier)
              (path_typ
                (typ_path
                  (type_identifier))))
            (val_tf
              (identifier)
              (path_typ
                (typ_path
                  (type_identifier)))))))
      (case
        (obj_pat
          (pat_field
            (identifier)
            (annot_pat
              (wild_pat)
              (typ_annot
                (path_typ
                  (typ_path
                    (type_identifier))))))
          (pat_field
            (identifier)
            (annot_pat
              (wild_pat)
              (typ_annot
                (path_typ
                  (typ_path
                    (type_identifier)))))))
        (block_exp))))
  (exp_dec
    (switch_exp
      (par_exp
        (annot_exp_object
          (call_exp_object
            (var_exp
              (identifier))
            (par_exp))
          (obj_typ
            (val_tf
              (identifier)
              (path_typ
                (typ_path
                  (type_identifier)))))))
      (case
        (tup_pat
          (annot_pat
            (var_pat
              (identifier))
            (typ_annot
              (obj_typ
                (val_tf
                  (identifier)
                  (path_typ
                    (typ_path
                      (type_identifier))))
                (val_tf
                  (identifier)
                  (path_typ
                    (typ_path
                      (type_identifier))))))))
        (block_exp))))
  (exp_dec
    (switch_exp
      (par_exp
        (annot_exp_object
          (call_exp_object
            (var_exp
              (identifier))
            (par_exp))
          (obj_typ
            (val_tf
              (identifier)
              (path_typ
                (typ_path
                  (type_identifier)))))))
      (case
        (tup_pat
          (annot_pat
            (obj_pat
              (pat_field
                (identifier))
              (pat_field
                (identifier)))
            (typ_annot
              (obj_typ
                (val_tf
                  (identifier)
                  (path_typ
                    (typ_path
                      (type_identifier))))
                (val_tf
                  (identifier)
                  (path_typ
                    (typ_path
                      (type_identifier))))))))
        (block_exp))))
  (exp_dec
    (switch_exp
      (par_exp
        (annot_exp_object
          (call_exp_object
            (var_exp
              (identifier))
            (par_exp))
          (obj_typ)))
      (case
        (tup_pat
          (annot_pat
            (var_pat
              (identifier))
            (typ_annot
              (obj_typ
                (val_tf
                  (identifier)
                  (path_typ
                    (typ_path
                      (type_identifier))))
                (val_tf
                  (identifier)
                  (path_typ
                    (typ_path
                      (type_identifier))))))))
        (block_exp))))
  (exp_dec
    (switch_exp
      (par_exp
        (annot_exp_object
          (call_exp_object
            (var_exp
              (identifier))
            (par_exp))
          (obj_typ)))
      (case
        (tup_pat
          (annot_pat
            (obj_pat
              (pat_field
                (identifier))
              (pat_field
                (identifier)))
            (typ_annot
              (obj_typ
                (val_tf
                  (identifier)
                  (path_typ
                    (typ_path
                      (type_identifier))))
                (val_tf
                  (identifier)
                  (path_typ
                    (typ_path
                      (type_identifier))))))))
        (block_exp))))
  (exp_dec
    (switch_exp
      (par_exp
        (annot_exp_object
          (call_exp_object
            (var_exp
              (identifier))
            (par_exp))
          (path_typ
            (typ_path
              (type_identifier)))))
      (case
        (tup_pat
          (lit_pat
            (null_literal)))
        (block_exp))
      (case
        (tup_pat
          (quest_pat
            (wild_pat)))
        (block_exp))))
  (exp_dec
    (switch_exp
      (par_exp
        (annot_exp_object
          (call_exp_object
            (var_exp
              (identifier))
            (par_exp))
          (quest_typ
            (path_typ
              (typ_path
                (type_identifier))))))
      (case
        (tup_pat
          (annot_pat
            (lit_pat
              (null_literal))
            (typ_annot
              (path_typ
                (typ_path
                  (type_identifier))))))
        (block_exp))
      (case
        (wild_pat)
        (block_exp))))
  (exp_dec
    (switch_exp
      (par_exp
        (annot_exp_object
          (call_exp_object
            (var_exp
              (identifier))
            (par_exp))
          (quest_typ
            (path_typ
              (typ_path
                (type_identifier))))))
      (case
        (tup_pat
          (annot_pat
            (quest_pat
              (var_pat
                (identifier)))
            (typ_annot
              (quest_typ
                (path_typ
                  (typ_path
                    (type_identifier)))))))
        (block_exp))
      (case
        (lit_pat
          (null_literal))
        (block_exp))))
  (exp_dec
    (switch_exp
      (par_exp
        (annot_exp_object
          (call_exp_object
            (var_exp
              (identifier))
            (par_exp))
          (quest_typ
            (path_typ
              (typ_path
                (type_identifier))))))
      (case
        (tup_pat
          (quest_pat
            (tup_pat
              (annot_pat
                (wild_pat)
                (typ_annot
                  (path_typ
                    (typ_path
                      (type_identifier))))))))
        (block_exp))
      (case
        (wild_pat)
        (block_exp))))
  (exp_dec
    (switch_exp
      (par_exp
        (annot_exp_object
          (call_exp_object
            (var_exp
              (identifier))
            (par_exp))
          (variant_typ)))
      (case
        (tup_pat
          (annot_pat
            (tag_pat
              (identifier)
              (wild_pat))
            (typ_annot
              (variant_typ
                (typ_tag
                  (identifier)
                  (typ_annot
                    (path_typ
                      (typ_path
                        (type_identifier)))))
                (typ_tag
                  (identifier))))))
        (block_exp))
      (line_comment)))
  (exp_dec
    (switch_exp
      (par_exp
        (annot_exp_object
          (call_exp_object
            (var_exp
              (identifier))
            (par_exp))
          (variant_typ
            (typ_tag
              (identifier)
              (typ_annot
                (path_typ
                  (typ_path
                    (type_identifier)))))
            (typ_tag
              (identifier)))))
      (case
        (tup_pat
          (annot_pat
            (tag_pat
              (identifier)
              (wild_pat))
            (typ_annot
              (variant_typ
                (typ_tag
                  (identifier)
                  (typ_annot
                    (path_typ
                      (typ_path
                        (type_identifier)))))))))
        (block_exp))
      (case
        (wild_pat)
        (block_exp))))
  (exp_dec
    (switch_exp
      (par_exp
        (annot_exp_object
          (call_exp_object
            (var_exp
              (identifier))
            (par_exp))
          (variant_typ
            (typ_tag
              (identifier)
              (typ_annot
                (path_typ
                  (typ_path
                    (type_identifier)))))
            (typ_tag
              (identifier)))))
      (case
        (tup_pat
          (annot_pat
            (tag_pat
              (identifier))
            (typ_annot
              (variant_typ
                (typ_tag
                  (identifier))))))
        (block_exp))
      (case
        (wild_pat)
        (block_exp))))
  (exp_dec
    (switch_exp
      (par_exp
        (call_exp_object
          (var_exp
            (identifier))
          (par_exp)))
      (case
        (lit_pat
          (bool_literal))
        (block_exp))
      (case
        (lit_pat
          (int_literal))
        (block_exp))))
  (exp_dec
    (do_exp
      (block_exp
        (func_dec
          (identifier)
          (tup_pat
            (annot_pat
              (annot_pat
                (var_pat
                  (identifier))
                (typ_annot
                  (path_typ
                    (typ_path
                      (type_identifier)))))
              (typ_annot
                (path_typ
                  (typ_path
                    (type_identifier))))))
          (func_body
            (block_exp)))
        (line_comment))))
  (exp_dec
    (do_exp
      (block_exp
        (func_dec
          (identifier)
          (tup_pat
            (annot_pat
              (annot_pat
                (var_pat
                  (identifier))
                (typ_annot
                  (path_typ
                    (typ_path
                      (type_identifier)))))
              (typ_annot
                (path_typ
                  (typ_path
                    (type_identifier))))))
          (func_body
            (block_exp))))))
  (exp_dec
    (do_exp
      (block_exp
        (func_dec
          (identifier)
          (tup_pat
            (annot_pat
              (annot_pat
                (annot_pat
                  (var_pat
                    (identifier))
                  (typ_annot
                    (path_typ
                      (typ_path
                        (type_identifier)))))
                (typ_annot
                  (path_typ
                    (typ_path
                      (type_identifier)))))
              (typ_annot
                (path_typ
                  (typ_path
                    (type_identifier))))))
          (func_body
            (block_exp))))))
  (exp_dec
    (do_exp
      (block_exp
        (func_dec
          (identifier)
          (tup_pat
            (annot_pat
              (annot_pat
                (annot_pat
                  (var_pat
                    (identifier))
                  (typ_annot
                    (path_typ
                      (typ_path
                        (type_identifier)))))
                (typ_annot
                  (path_typ
                    (typ_path
                      (type_identifier)))))
              (typ_annot
                (path_typ
                  (typ_path
                    (type_identifier))))))
          (func_body
            (block_exp))))))
  (exp_dec
    (do_exp
      (block_exp
        (exp_dec
          (ignore_exp
            (annot_exp_block
              (par_exp
                (func_exp
                  (tup_pat
                    (annot_pat
                      (var_pat
                        (identifier))
                      (typ_annot
                        (path_typ
                          (typ_path
                            (type_identifier))))))
                  (func_body
                    (block_exp))))
              (tup_typ
                (typ_item
                  (func_typ
                    (path_typ
                      (typ_path
                        (type_identifier)))
                    (tup_typ)))))))
        (line_comment))))
  (exp_dec
    (do_exp
      (block_exp
        (exp_dec
          (ignore_exp
            (annot_exp_block
              (par_exp
                (func_exp
                  (tup_pat
                    (annot_pat
                      (var_pat
                        (identifier))
                      (typ_annot
                        (path_typ
                          (typ_path
                            (type_identifier))))))
                  (func_body
                    (block_exp))))
              (tup_typ
                (typ_item
                  (func_typ
                    (path_typ
                      (typ_path
                        (type_identifier)))
                    (tup_typ))))))))))
  (exp_dec
    (do_exp
      (block_exp
        (exp_dec
          (ignore_exp
            (annot_exp_block
              (par_exp
                (func_exp
                  (tup_pat
                    (annot_pat
                      (annot_pat
                        (var_pat
                          (identifier))
                        (typ_annot
                          (path_typ
                            (typ_path
                              (type_identifier)))))
                      (typ_annot
                        (path_typ
                          (typ_path
                            (type_identifier))))))
                  (func_body
                    (block_exp))))
              (tup_typ
                (typ_item
                  (func_typ
                    (path_typ
                      (typ_path
                        (type_identifier)))
                    (tup_typ))))))))))
  (exp_dec
    (do_exp
      (block_exp
        (exp_dec
          (ignore_exp
            (annot_exp_block
              (par_exp
                (func_exp
                  (tup_pat
                    (annot_pat
                      (annot_pat
                        (var_pat
                          (identifier))
                        (typ_annot
                          (path_typ
                            (typ_path
                              (type_identifier)))))
                      (typ_annot
                        (path_typ
                          (typ_path
                            (type_identifier))))))
                  (func_body
                    (block_exp))))
              (tup_typ
                (typ_item
                  (func_typ
                    (path_typ
                      (typ_path
                        (type_identifier)))
                    (tup_typ))))))))))
  (exp_dec
    (do_exp
      (block_exp
        (exp_dec
          (ignore_exp
            (annot_exp_block
              (par_exp
                (func_dec
                  (identifier)
                  (tup_pat
                    (annot_pat
                      (var_pat
                        (identifier))
                      (typ_annot
                        (path_typ
                          (typ_path
                            (type_identifier))))))
                  (func_body
                    (block_exp))))
              (tup_typ
                (typ_item
                  (func_typ
                    (path_typ
                      (typ_path
                        (type_identifier)))
                    (tup_typ)))))))
        (line_comment))))
  (exp_dec
    (do_exp
      (block_exp
        (exp_dec
          (ignore_exp
            (annot_exp_block
              (par_exp
                (func_dec
                  (identifier)
                  (tup_pat
                    (annot_pat
                      (var_pat
                        (identifier))
                      (typ_annot
                        (path_typ
                          (typ_path
                            (type_identifier))))))
                  (func_body
                    (block_exp))))
              (tup_typ
                (typ_item
                  (func_typ
                    (path_typ
                      (typ_path
                        (type_identifier)))
                    (tup_typ))))))))))
  (exp_dec
    (do_exp
      (block_exp
        (exp_dec
          (ignore_exp
            (annot_exp_block
              (par_exp
                (func_dec
                  (identifier)
                  (tup_pat
                    (annot_pat
                      (annot_pat
                        (var_pat
                          (identifier))
                        (typ_annot
                          (path_typ
                            (typ_path
                              (type_identifier)))))
                      (typ_annot
                        (path_typ
                          (typ_path
                            (type_identifier))))))
                  (func_body
                    (block_exp))))
              (tup_typ
                (typ_item
                  (func_typ
                    (path_typ
                      (typ_path
                        (type_identifier)))
                    (tup_typ))))))))))
  (exp_dec
    (do_exp
      (block_exp
        (exp_dec
          (ignore_exp
            (annot_exp_block
              (par_exp
                (func_dec
                  (identifier)
                  (tup_pat
                    (annot_pat
                      (annot_pat
                        (var_pat
                          (identifier))
                        (typ_annot
                          (path_typ
                            (typ_path
                              (type_identifier)))))
                      (typ_annot
                        (path_typ
                          (typ_path
                            (type_identifier))))))
                  (func_body
                    (block_exp))))
              (tup_typ
                (typ_item
                  (func_typ
                    (path_typ
                      (typ_path
                        (type_identifier)))
                    (tup_typ)))))))))))
