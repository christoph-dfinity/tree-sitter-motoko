=========
issue-3318.mo
=========


func h<A,B>(f: A -> B) { };
type T = (Int, Int);
func f(x: (Nat, Nat)) : (Int, Int) { x };
func g(x: (Nat, Nat)) : T { x };
h<(Nat,Nat),(Int,Int)>(f); // reject
h<(Nat,Nat),(Int,Int)>(g); // accept


// function arity is syntactic and must match
func t0(f: (Nat, Nat) -> (Nat, Nat))
         : (Nat, Nat) -> (Nat, Nat) = f; // accept

func t1(f: (Nat, Nat) -> (Nat, Nat))
         : (Nat, Nat) -> ((Nat, Nat)) = f; // reject

func t2(f: (Nat, Nat) -> (Nat, Nat))
         : ((Nat, Nat)) -> (Nat, Nat) = f; // reject

func t3(f: (Nat, Nat) -> (Nat, Nat))
         : ((Nat, Nat)) -> ((Nat, Nat)) = f; // reject

func t4(f: (Nat, Nat) -> ((Nat, Nat)))
         : (Nat, Nat) -> (Nat, Nat) = f; // reject

func t5(f: (Nat, Nat) -> ((Nat, Nat)))
         : (Nat, Nat) -> ((Nat, Nat)) = f; // accept

func t6(f: ((Nat, Nat)) -> (Nat, Nat))
         : ((Nat, Nat)) -> (Nat, Nat) = f; // accept

func t7(f: (Nat, Nat) -> ((Nat, Nat)))
         : ((Nat, Nat)) -> ((Nat, Nat)) = f; // reject

func t8(f: ((Nat, Nat)) -> ((Nat, Nat)))
         : ((Nat, Nat)) -> ((Nat, Nat)) = f; // accept


// unary tuples don't exist
func u0(f: Nat -> Nat)
         : Nat -> Nat = f; // accept
func u1(f: Nat -> Nat)
         : (Nat,) -> (Nat,) = f; // accept
func u2(f: Nat -> Nat)
         : (Nat) -> (Nat) = f; // accept













---

(source_file
  (func_dec
    (identifier)
    (typ_params
      (typ_bind
        (type_identifier))
      (typ_bind
        (type_identifier)))
    (tup_pat
      (annot_pat
        (var_pat
          (identifier))
        (typ_annot
          (func_typ
            (path_typ
              (typ_path
                (type_identifier)))
            (path_typ
              (typ_path
                (type_identifier)))))))
    (func_body
      (block_exp)))
  (typ_dec
    (type_identifier)
    (tup_typ
      (typ_item
        (path_typ
          (typ_path
            (type_identifier))))
      (typ_item
        (path_typ
          (typ_path
            (type_identifier))))))
  (func_dec
    (identifier)
    (tup_pat
      (annot_pat
        (var_pat
          (identifier))
        (typ_annot
          (tup_typ
            (typ_item
              (path_typ
                (typ_path
                  (type_identifier))))
            (typ_item
              (path_typ
                (typ_path
                  (type_identifier))))))))
    (typ_annot
      (tup_typ
        (typ_item
          (path_typ
            (typ_path
              (type_identifier))))
        (typ_item
          (path_typ
            (typ_path
              (type_identifier))))))
    (func_body
      (block_exp
        (exp_dec
          (var_exp
            (identifier))))))
  (func_dec
    (identifier)
    (tup_pat
      (annot_pat
        (var_pat
          (identifier))
        (typ_annot
          (tup_typ
            (typ_item
              (path_typ
                (typ_path
                  (type_identifier))))
            (typ_item
              (path_typ
                (typ_path
                  (type_identifier))))))))
    (typ_annot
      (path_typ
        (typ_path
          (type_identifier))))
    (func_body
      (block_exp
        (exp_dec
          (var_exp
            (identifier))))))
  (exp_dec
    (call_exp_object
      (var_exp
        (identifier))
      (inst
        (tup_typ
          (typ_item
            (path_typ
              (typ_path
                (type_identifier))))
          (typ_item
            (path_typ
              (typ_path
                (type_identifier)))))
        (tup_typ
          (typ_item
            (path_typ
              (typ_path
                (type_identifier))))
          (typ_item
            (path_typ
              (typ_path
                (type_identifier))))))
      (par_exp
        (var_exp
          (identifier)))))
  (line_comment)
  (exp_dec
    (call_exp_object
      (var_exp
        (identifier))
      (inst
        (tup_typ
          (typ_item
            (path_typ
              (typ_path
                (type_identifier))))
          (typ_item
            (path_typ
              (typ_path
                (type_identifier)))))
        (tup_typ
          (typ_item
            (path_typ
              (typ_path
                (type_identifier))))
          (typ_item
            (path_typ
              (typ_path
                (type_identifier))))))
      (par_exp
        (var_exp
          (identifier)))))
  (line_comment)
  (line_comment)
  (func_dec
    (identifier)
    (tup_pat
      (annot_pat
        (var_pat
          (identifier))
        (typ_annot
          (func_typ
            (tup_typ
              (typ_item
                (path_typ
                  (typ_path
                    (type_identifier))))
              (typ_item
                (path_typ
                  (typ_path
                    (type_identifier)))))
            (tup_typ
              (typ_item
                (path_typ
                  (typ_path
                    (type_identifier))))
              (typ_item
                (path_typ
                  (typ_path
                    (type_identifier)))))))))
    (typ_annot
      (func_typ
        (tup_typ
          (typ_item
            (path_typ
              (typ_path
                (type_identifier))))
          (typ_item
            (path_typ
              (typ_path
                (type_identifier)))))
        (tup_typ
          (typ_item
            (path_typ
              (typ_path
                (type_identifier))))
          (typ_item
            (path_typ
              (typ_path
                (type_identifier)))))))
    (func_body
      (var_exp
        (identifier))))
  (line_comment)
  (func_dec
    (identifier)
    (tup_pat
      (annot_pat
        (var_pat
          (identifier))
        (typ_annot
          (func_typ
            (tup_typ
              (typ_item
                (path_typ
                  (typ_path
                    (type_identifier))))
              (typ_item
                (path_typ
                  (typ_path
                    (type_identifier)))))
            (tup_typ
              (typ_item
                (path_typ
                  (typ_path
                    (type_identifier))))
              (typ_item
                (path_typ
                  (typ_path
                    (type_identifier)))))))))
    (typ_annot
      (func_typ
        (tup_typ
          (typ_item
            (path_typ
              (typ_path
                (type_identifier))))
          (typ_item
            (path_typ
              (typ_path
                (type_identifier)))))
        (tup_typ
          (typ_item
            (tup_typ
              (typ_item
                (path_typ
                  (typ_path
                    (type_identifier))))
              (typ_item
                (path_typ
                  (typ_path
                    (type_identifier)))))))))
    (func_body
      (var_exp
        (identifier))))
  (line_comment)
  (func_dec
    (identifier)
    (tup_pat
      (annot_pat
        (var_pat
          (identifier))
        (typ_annot
          (func_typ
            (tup_typ
              (typ_item
                (path_typ
                  (typ_path
                    (type_identifier))))
              (typ_item
                (path_typ
                  (typ_path
                    (type_identifier)))))
            (tup_typ
              (typ_item
                (path_typ
                  (typ_path
                    (type_identifier))))
              (typ_item
                (path_typ
                  (typ_path
                    (type_identifier)))))))))
    (typ_annot
      (func_typ
        (tup_typ
          (typ_item
            (tup_typ
              (typ_item
                (path_typ
                  (typ_path
                    (type_identifier))))
              (typ_item
                (path_typ
                  (typ_path
                    (type_identifier)))))))
        (tup_typ
          (typ_item
            (path_typ
              (typ_path
                (type_identifier))))
          (typ_item
            (path_typ
              (typ_path
                (type_identifier)))))))
    (func_body
      (var_exp
        (identifier))))
  (line_comment)
  (func_dec
    (identifier)
    (tup_pat
      (annot_pat
        (var_pat
          (identifier))
        (typ_annot
          (func_typ
            (tup_typ
              (typ_item
                (path_typ
                  (typ_path
                    (type_identifier))))
              (typ_item
                (path_typ
                  (typ_path
                    (type_identifier)))))
            (tup_typ
              (typ_item
                (path_typ
                  (typ_path
                    (type_identifier))))
              (typ_item
                (path_typ
                  (typ_path
                    (type_identifier)))))))))
    (typ_annot
      (func_typ
        (tup_typ
          (typ_item
            (tup_typ
              (typ_item
                (path_typ
                  (typ_path
                    (type_identifier))))
              (typ_item
                (path_typ
                  (typ_path
                    (type_identifier)))))))
        (tup_typ
          (typ_item
            (tup_typ
              (typ_item
                (path_typ
                  (typ_path
                    (type_identifier))))
              (typ_item
                (path_typ
                  (typ_path
                    (type_identifier)))))))))
    (func_body
      (var_exp
        (identifier))))
  (line_comment)
  (func_dec
    (identifier)
    (tup_pat
      (annot_pat
        (var_pat
          (identifier))
        (typ_annot
          (func_typ
            (tup_typ
              (typ_item
                (path_typ
                  (typ_path
                    (type_identifier))))
              (typ_item
                (path_typ
                  (typ_path
                    (type_identifier)))))
            (tup_typ
              (typ_item
                (tup_typ
                  (typ_item
                    (path_typ
                      (typ_path
                        (type_identifier))))
                  (typ_item
                    (path_typ
                      (typ_path
                        (type_identifier)))))))))))
    (typ_annot
      (func_typ
        (tup_typ
          (typ_item
            (path_typ
              (typ_path
                (type_identifier))))
          (typ_item
            (path_typ
              (typ_path
                (type_identifier)))))
        (tup_typ
          (typ_item
            (path_typ
              (typ_path
                (type_identifier))))
          (typ_item
            (path_typ
              (typ_path
                (type_identifier)))))))
    (func_body
      (var_exp
        (identifier))))
  (line_comment)
  (func_dec
    (identifier)
    (tup_pat
      (annot_pat
        (var_pat
          (identifier))
        (typ_annot
          (func_typ
            (tup_typ
              (typ_item
                (path_typ
                  (typ_path
                    (type_identifier))))
              (typ_item
                (path_typ
                  (typ_path
                    (type_identifier)))))
            (tup_typ
              (typ_item
                (tup_typ
                  (typ_item
                    (path_typ
                      (typ_path
                        (type_identifier))))
                  (typ_item
                    (path_typ
                      (typ_path
                        (type_identifier)))))))))))
    (typ_annot
      (func_typ
        (tup_typ
          (typ_item
            (path_typ
              (typ_path
                (type_identifier))))
          (typ_item
            (path_typ
              (typ_path
                (type_identifier)))))
        (tup_typ
          (typ_item
            (tup_typ
              (typ_item
                (path_typ
                  (typ_path
                    (type_identifier))))
              (typ_item
                (path_typ
                  (typ_path
                    (type_identifier)))))))))
    (func_body
      (var_exp
        (identifier))))
  (line_comment)
  (func_dec
    (identifier)
    (tup_pat
      (annot_pat
        (var_pat
          (identifier))
        (typ_annot
          (func_typ
            (tup_typ
              (typ_item
                (tup_typ
                  (typ_item
                    (path_typ
                      (typ_path
                        (type_identifier))))
                  (typ_item
                    (path_typ
                      (typ_path
                        (type_identifier)))))))
            (tup_typ
              (typ_item
                (path_typ
                  (typ_path
                    (type_identifier))))
              (typ_item
                (path_typ
                  (typ_path
                    (type_identifier)))))))))
    (typ_annot
      (func_typ
        (tup_typ
          (typ_item
            (tup_typ
              (typ_item
                (path_typ
                  (typ_path
                    (type_identifier))))
              (typ_item
                (path_typ
                  (typ_path
                    (type_identifier)))))))
        (tup_typ
          (typ_item
            (path_typ
              (typ_path
                (type_identifier))))
          (typ_item
            (path_typ
              (typ_path
                (type_identifier)))))))
    (func_body
      (var_exp
        (identifier))))
  (line_comment)
  (func_dec
    (identifier)
    (tup_pat
      (annot_pat
        (var_pat
          (identifier))
        (typ_annot
          (func_typ
            (tup_typ
              (typ_item
                (path_typ
                  (typ_path
                    (type_identifier))))
              (typ_item
                (path_typ
                  (typ_path
                    (type_identifier)))))
            (tup_typ
              (typ_item
                (tup_typ
                  (typ_item
                    (path_typ
                      (typ_path
                        (type_identifier))))
                  (typ_item
                    (path_typ
                      (typ_path
                        (type_identifier)))))))))))
    (typ_annot
      (func_typ
        (tup_typ
          (typ_item
            (tup_typ
              (typ_item
                (path_typ
                  (typ_path
                    (type_identifier))))
              (typ_item
                (path_typ
                  (typ_path
                    (type_identifier)))))))
        (tup_typ
          (typ_item
            (tup_typ
              (typ_item
                (path_typ
                  (typ_path
                    (type_identifier))))
              (typ_item
                (path_typ
                  (typ_path
                    (type_identifier)))))))))
    (func_body
      (var_exp
        (identifier))))
  (line_comment)
  (func_dec
    (identifier)
    (tup_pat
      (annot_pat
        (var_pat
          (identifier))
        (typ_annot
          (func_typ
            (tup_typ
              (typ_item
                (tup_typ
                  (typ_item
                    (path_typ
                      (typ_path
                        (type_identifier))))
                  (typ_item
                    (path_typ
                      (typ_path
                        (type_identifier)))))))
            (tup_typ
              (typ_item
                (tup_typ
                  (typ_item
                    (path_typ
                      (typ_path
                        (type_identifier))))
                  (typ_item
                    (path_typ
                      (typ_path
                        (type_identifier)))))))))))
    (typ_annot
      (func_typ
        (tup_typ
          (typ_item
            (tup_typ
              (typ_item
                (path_typ
                  (typ_path
                    (type_identifier))))
              (typ_item
                (path_typ
                  (typ_path
                    (type_identifier)))))))
        (tup_typ
          (typ_item
            (tup_typ
              (typ_item
                (path_typ
                  (typ_path
                    (type_identifier))))
              (typ_item
                (path_typ
                  (typ_path
                    (type_identifier)))))))))
    (func_body
      (var_exp
        (identifier))))
  (line_comment)
  (line_comment)
  (func_dec
    (identifier)
    (tup_pat
      (annot_pat
        (var_pat
          (identifier))
        (typ_annot
          (func_typ
            (path_typ
              (typ_path
                (type_identifier)))
            (path_typ
              (typ_path
                (type_identifier)))))))
    (typ_annot
      (func_typ
        (path_typ
          (typ_path
            (type_identifier)))
        (path_typ
          (typ_path
            (type_identifier)))))
    (func_body
      (var_exp
        (identifier))))
  (line_comment)
  (func_dec
    (identifier)
    (tup_pat
      (annot_pat
        (var_pat
          (identifier))
        (typ_annot
          (func_typ
            (path_typ
              (typ_path
                (type_identifier)))
            (path_typ
              (typ_path
                (type_identifier)))))))
    (typ_annot
      (func_typ
        (tup_typ
          (typ_item
            (path_typ
              (typ_path
                (type_identifier)))))
        (tup_typ
          (typ_item
            (path_typ
              (typ_path
                (type_identifier)))))))
    (func_body
      (var_exp
        (identifier))))
  (line_comment)
  (func_dec
    (identifier)
    (tup_pat
      (annot_pat
        (var_pat
          (identifier))
        (typ_annot
          (func_typ
            (path_typ
              (typ_path
                (type_identifier)))
            (path_typ
              (typ_path
                (type_identifier)))))))
    (typ_annot
      (func_typ
        (tup_typ
          (typ_item
            (path_typ
              (typ_path
                (type_identifier)))))
        (tup_typ
          (typ_item
            (path_typ
              (typ_path
                (type_identifier)))))))
    (func_body
      (var_exp
        (identifier))))
  (line_comment))
