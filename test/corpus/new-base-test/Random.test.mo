=========
Random.test.mo
=========

import Random "../src/Random";
import Int "../src/Int";
import Nat "../src/Nat";
import Nat8 "../src/Nat8";
import Nat64 "../src/Nat64";
import Float "../src/Float";
import Bool "../src/Bool";
import Array "../src/Array";
import { suite; test; expect } = "mo:test/async";

await suite(
  "Random.fast()",
  func() : async () {
    await test(
      "bool(), seed = 0",
      func() : async () {
        let random = Random.fast(0);
        let expected = [false, false, false, true, true, false, true, true, false, false];
        expect.array(Array.tabulate<Bool>(10, func _ = random.bool()), Bool.toText, Bool.equal).equal(expected)
      }
    );
    await test(
      "bool(), seed = 123456789",
      func() : async () {
        let random = Random.fast(123456789);
        let expected = [false, false, true, false, true, false, false, true, true, false];
        expect.array(Array.tabulate<Bool>(10, func _ = random.bool()), Bool.toText, Bool.equal).equal(expected)
      }
    );
    await test(
      "bool() has approximately uniform distribution",
      func() : async () {
        let random = Random.fast(0);
        var trueCount = 0;
        let trials = 10000;
        for (_ in Nat.range(0, trials)) {
          if (random.bool()) trueCount += 1
        };
        let ratio = Float.fromInt(trueCount) / Float.fromInt(trials);
        assert ratio > 0.49 and ratio < 0.51
      }
    );
    await test(
      "nat8(), seed = 0",
      func() : async () {
        let random = Random.fast(0);
        let expected : [Nat8] = [27, 58, 135, 48, 175, 107, 232, 146, 65, 96];
        expect.array(Array.tabulate<Nat8>(10, func _ = random.nat8()), Nat8.toText, Nat8.equal).equal(expected)
      }
    );
    await test(
      "nat8(), seed = 123456789",
      func() : async () {
        let random = Random.fast(123456789);
        let expected : [Nat8] = [41, 152, 30, 100, 244, 79, 22, 249, 53, 2];
        expect.array(Array.tabulate<Nat8>(10, func _ = random.nat8()), Nat8.toText, Nat8.equal).equal(expected)
      }
    );
    await test(
      "nat64(), seed = 0",
      func() : async () {
        let random = Random.fast(0);
        let expected : [Nat64] = [
          1962029230844536978,
          4710990486257585978,
          11259543268084528885,
          7033394001090926866,
          15486745063885072907
        ];
        expect.array(Array.tabulate<Nat64>(5, func _ = random.nat64()), Nat64.toText, Nat64.equal).equal(expected)
      }
    );
    await test(
      "nat64(), seed = 123456789",
      func() : async () {
        let random = Random.fast(123456789);
        let expected : [Nat64] = [
          2997178970959451897,
          3819629392862388853,
          8480465938905851716,
          17030162763326561265,
          439678832541472697
        ];
        expect.array(Array.tabulate<Nat64>(5, func _ = random.nat64()), Nat64.toText, Nat64.equal).equal(expected)
      }
    );
    await test(
      "nat64() has approximately uniform distribution",
      func() : async () {
        let random = Random.fast(0);
        let trials = 10000;
        var sum = 0;
        for (_ in Nat.range(0, trials)) {
          sum += Nat64.toNat(random.nat64())
        };
        let avg = sum / trials;
        let expectedAvg = Nat64.toNat(Nat64.maxValue) / 2;
        assert Int.abs(avg - expectedAvg : Int) < expectedAvg / 100
      }
    );
    await test(
      "nat64Range() returns values within range",
      func() : async () {
        let random = Random.fast(0);
        let from : Nat64 = 10;
        let toExclusive : Nat64 = 20;
        for (_ in Nat.range(0, 1000)) {
          let val = random.nat64Range(from, toExclusive);
          assert val >= from and val < toExclusive
        }
      }
    );
    await test(
      "natRange() has approximately uniform distribution",
      func() : async () {
        let random = Random.fast(0);
        let from = 1000;
        let toExclusive = 2000;
        let trials = 10000;
        var sum = 0;
        for (_ in Nat.range(0, trials)) {
          sum += random.natRange(from, toExclusive)
        };
        let avg = sum / trials;
        let expectedAvg = from + (toExclusive - from : Nat) / 2;
        assert Int.abs(avg - expectedAvg : Int) < (toExclusive - from : Nat) / 100
      }
    );
    await test(
      "natRange() returns values within range",
      func() : async () {
        let random = Random.fast(0);
        let from = 10;
        let toExclusive = 20;
        for (_ in Nat.range(0, 1000)) {
          let val = random.natRange(from, toExclusive);
          assert val >= from and val < toExclusive
        }
      }
    );
    await test(
      "intRange() has approximately uniform distribution",
      func() : async () {
        let random = Random.fast(0);
        let from = -1000;
        let toExclusive = +1000;
        let trials = 10000;
        var sum = +0;
        for (_ in Nat.range(0, trials)) {
          sum += random.intRange(from, toExclusive)
        };
        let avg = sum / trials;
        let expectedAvg = from + (toExclusive - from) / 2;
        assert Int.abs(avg - expectedAvg) < (toExclusive - from) / 100
      }
    );
    await test(
      "intRange() returns values within range",
      func() : async () {
        let random = Random.fast(0);
        let from = -10;
        let toExclusive = 10;
        for (_ in Nat.range(0, 1000)) {
          let val = random.intRange(from, toExclusive);
          assert val >= from and val < toExclusive
        }
      }
    );
    await test(
      "*range()",
      func() : async () {
        let random = Random.fast(0);

        let rangeFunctions : [(Nat, Nat) -> Int] = [
          func(a, b) = Nat64.toNat(random.nat64Range(Nat64.fromNat(a), Nat64.fromNat(b))),
          func(a, b) = Nat.toInt(random.natRange(a, b)),
          random.intRange
        ];
        for (f in rangeFunctions.vals()) {
          // (i, i + 1)
          for (i in Nat.range(0, 10)) {
            assert f(i, i + 1) == i
          };

          // (i, i + 2)
          var count0 = 0;
          var count1 = 0;
          for (i in Nat.range(0, 10)) {
            let n = f(i, i + 2);
            if (n == i) {
              count0 += 1
            } else if (n == i + 1) {
              count1 += 1
            } else {
              assert false
            }
          };
          assert count0 > 0;
          assert count1 > 0;

          // (i, i + 3)
          count0 := 0;
          count1 := 0;
          var count2 = 0;
          for (i in Nat.range(0, 10)) {
            let n = f(i, i + 3);
            if (n == i) {
              count0 += 1
            } else if (n == i + 1) {
              count1 += 1
            } else if (n == i + 2) {
              count2 += 1
            } else {
              assert false
            }
          };
          assert count0 > 0;
          assert count1 > 0;
          assert count2 > 0
        }
      }
    )
  }
);

await suite(
  "Random.crypto()",
  func() : async () {
    await test(
      "nat64Range() returns values within range",
      func() : async () {
        let random = Random.fast(0);
        let from : Nat64 = 10;
        let toExclusive : Nat64 = 20;
        for (_ in Nat.range(0, 1000)) {
          let val = random.nat64Range(from, toExclusive);
          assert val >= from and val < toExclusive
        }
      }
    );
    await test(
      "natRange() returns values within range",
      func() : async () {
        let random = Random.fast(0);
        let from = 10;
        let toExclusive = 20;
        for (_ in Nat.range(0, 1000)) {
          let val = random.natRange(from, toExclusive);
          assert val >= from and val < toExclusive
        }
      }
    );
    await test(
      "intRange() returns values within range",
      func() : async () {
        let random = Random.fast(0);
        let from = -10;
        let toExclusive = 10;
        for (_ in Nat.range(0, 1000)) {
          let val = random.intRange(from, toExclusive);
          assert val >= from and val < toExclusive
        }
      }
    )
  }
)

---

(source_file
  (import
    (var_pat
      (identifier))
    (text_literal))
  (import
    (var_pat
      (identifier))
    (text_literal))
  (import
    (var_pat
      (identifier))
    (text_literal))
  (import
    (var_pat
      (identifier))
    (text_literal))
  (import
    (var_pat
      (identifier))
    (text_literal))
  (import
    (var_pat
      (identifier))
    (text_literal))
  (import
    (var_pat
      (identifier))
    (text_literal))
  (import
    (var_pat
      (identifier))
    (text_literal))
  (import
    (obj_pat
      (pat_field
        (identifier))
      (pat_field
        (identifier))
      (pat_field
        (identifier)))
    (text_literal))
  (exp_dec
    (await_exp
      (call_exp_block
        (var_exp
          (identifier))
        (par_exp
          (lit_exp
            (text_literal))
          (func_exp
            (tup_pat)
            (typ_annot
              (async_typ
                (tup_typ)))
            (func_body
              (block_exp
                (exp_dec
                  (await_exp
                    (call_exp_block
                      (var_exp
                        (identifier))
                      (par_exp
                        (lit_exp
                          (text_literal))
                        (func_exp
                          (tup_pat)
                          (typ_annot
                            (async_typ
                              (tup_typ)))
                          (func_body
                            (block_exp
                              (let_dec
                                (var_pat
                                  (identifier))
                                (call_exp_object
                                  (dot_exp_object
                                    (var_exp
                                      (identifier))
                                    (identifier))
                                  (par_exp
                                    (lit_exp
                                      (int_literal)))))
                              (let_dec
                                (var_pat
                                  (identifier))
                                (array_exp
                                  (lit_exp
                                    (bool_literal))
                                  (lit_exp
                                    (bool_literal))
                                  (lit_exp
                                    (bool_literal))
                                  (lit_exp
                                    (bool_literal))
                                  (lit_exp
                                    (bool_literal))
                                  (lit_exp
                                    (bool_literal))
                                  (lit_exp
                                    (bool_literal))
                                  (lit_exp
                                    (bool_literal))
                                  (lit_exp
                                    (bool_literal))
                                  (lit_exp
                                    (bool_literal))))
                              (exp_dec
                                (call_exp_object
                                  (dot_exp_object
                                    (call_exp_object
                                      (dot_exp_object
                                        (var_exp
                                          (identifier))
                                        (identifier))
                                      (par_exp
                                        (call_exp_object
                                          (dot_exp_object
                                            (var_exp
                                              (identifier))
                                            (identifier))
                                          (inst
                                            (path_typ
                                              (typ_path
                                                (type_identifier))))
                                          (par_exp
                                            (lit_exp
                                              (int_literal))
                                            (func_exp
                                              (wild_pat)
                                              (func_body
                                                (call_exp_object
                                                  (dot_exp_object
                                                    (var_exp
                                                      (identifier))
                                                    (identifier))
                                                  (par_exp))))))
                                        (dot_exp_object
                                          (var_exp
                                            (identifier))
                                          (identifier))
                                        (dot_exp_object
                                          (var_exp
                                            (identifier))
                                          (identifier))))
                                    (identifier))
                                  (par_exp
                                    (var_exp
                                      (identifier))))))))))))
                (exp_dec
                  (await_exp
                    (call_exp_block
                      (var_exp
                        (identifier))
                      (par_exp
                        (lit_exp
                          (text_literal))
                        (func_exp
                          (tup_pat)
                          (typ_annot
                            (async_typ
                              (tup_typ)))
                          (func_body
                            (block_exp
                              (let_dec
                                (var_pat
                                  (identifier))
                                (call_exp_object
                                  (dot_exp_object
                                    (var_exp
                                      (identifier))
                                    (identifier))
                                  (par_exp
                                    (lit_exp
                                      (int_literal)))))
                              (let_dec
                                (var_pat
                                  (identifier))
                                (array_exp
                                  (lit_exp
                                    (bool_literal))
                                  (lit_exp
                                    (bool_literal))
                                  (lit_exp
                                    (bool_literal))
                                  (lit_exp
                                    (bool_literal))
                                  (lit_exp
                                    (bool_literal))
                                  (lit_exp
                                    (bool_literal))
                                  (lit_exp
                                    (bool_literal))
                                  (lit_exp
                                    (bool_literal))
                                  (lit_exp
                                    (bool_literal))
                                  (lit_exp
                                    (bool_literal))))
                              (exp_dec
                                (call_exp_object
                                  (dot_exp_object
                                    (call_exp_object
                                      (dot_exp_object
                                        (var_exp
                                          (identifier))
                                        (identifier))
                                      (par_exp
                                        (call_exp_object
                                          (dot_exp_object
                                            (var_exp
                                              (identifier))
                                            (identifier))
                                          (inst
                                            (path_typ
                                              (typ_path
                                                (type_identifier))))
                                          (par_exp
                                            (lit_exp
                                              (int_literal))
                                            (func_exp
                                              (wild_pat)
                                              (func_body
                                                (call_exp_object
                                                  (dot_exp_object
                                                    (var_exp
                                                      (identifier))
                                                    (identifier))
                                                  (par_exp))))))
                                        (dot_exp_object
                                          (var_exp
                                            (identifier))
                                          (identifier))
                                        (dot_exp_object
                                          (var_exp
                                            (identifier))
                                          (identifier))))
                                    (identifier))
                                  (par_exp
                                    (var_exp
                                      (identifier))))))))))))
                (exp_dec
                  (await_exp
                    (call_exp_block
                      (var_exp
                        (identifier))
                      (par_exp
                        (lit_exp
                          (text_literal))
                        (func_exp
                          (tup_pat)
                          (typ_annot
                            (async_typ
                              (tup_typ)))
                          (func_body
                            (block_exp
                              (let_dec
                                (var_pat
                                  (identifier))
                                (call_exp_object
                                  (dot_exp_object
                                    (var_exp
                                      (identifier))
                                    (identifier))
                                  (par_exp
                                    (lit_exp
                                      (int_literal)))))
                              (var_dec
                                (var_pat
                                  (identifier))
                                (lit_exp
                                  (int_literal)))
                              (let_dec
                                (var_pat
                                  (identifier))
                                (lit_exp
                                  (int_literal)))
                              (exp_dec
                                (for_exp
                                  (wild_pat)
                                  (call_exp_object
                                    (dot_exp_object
                                      (var_exp
                                        (identifier))
                                      (identifier))
                                    (par_exp
                                      (lit_exp
                                        (int_literal))
                                      (var_exp
                                        (identifier))))
                                  (block_exp
                                    (exp_dec
                                      (if_exp
                                        (par_exp
                                          (call_exp_object
                                            (dot_exp_object
                                              (var_exp
                                                (identifier))
                                              (identifier))
                                            (par_exp)))
                                        (binassign_exp_block
                                          (var_exp
                                            (identifier))
                                          (binassign_op)
                                          (lit_exp
                                            (int_literal))))))))
                              (let_dec
                                (var_pat
                                  (identifier))
                                (bin_exp_object
                                  (call_exp_object
                                    (dot_exp_object
                                      (var_exp
                                        (identifier))
                                      (identifier))
                                    (par_exp
                                      (var_exp
                                        (identifier))))
                                  (bin_op)
                                  (call_exp_object
                                    (dot_exp_object
                                      (var_exp
                                        (identifier))
                                      (identifier))
                                    (par_exp
                                      (var_exp
                                        (identifier))))))
                              (exp_dec
                                (assert_exp
                                  (bin_exp_block
                                    (bin_exp_block
                                      (bin_exp_block
                                        (var_exp
                                          (identifier))
                                        (rel_op)
                                        (lit_exp
                                          (float_literal)))
                                      (bin_op)
                                      (var_exp
                                        (identifier)))
                                    (rel_op)
                                    (lit_exp
                                      (float_literal))))))))))))
                (exp_dec
                  (await_exp
                    (call_exp_block
                      (var_exp
                        (identifier))
                      (par_exp
                        (lit_exp
                          (text_literal))
                        (func_exp
                          (tup_pat)
                          (typ_annot
                            (async_typ
                              (tup_typ)))
                          (func_body
                            (block_exp
                              (let_dec
                                (var_pat
                                  (identifier))
                                (call_exp_object
                                  (dot_exp_object
                                    (var_exp
                                      (identifier))
                                    (identifier))
                                  (par_exp
                                    (lit_exp
                                      (int_literal)))))
                              (let_dec
                                (annot_pat
                                  (var_pat
                                    (identifier))
                                  (typ_annot
                                    (array_typ
                                      (path_typ
                                        (typ_path
                                          (type_identifier))))))
                                (array_exp
                                  (lit_exp
                                    (int_literal))
                                  (lit_exp
                                    (int_literal))
                                  (lit_exp
                                    (int_literal))
                                  (lit_exp
                                    (int_literal))
                                  (lit_exp
                                    (int_literal))
                                  (lit_exp
                                    (int_literal))
                                  (lit_exp
                                    (int_literal))
                                  (lit_exp
                                    (int_literal))
                                  (lit_exp
                                    (int_literal))
                                  (lit_exp
                                    (int_literal))))
                              (exp_dec
                                (call_exp_object
                                  (dot_exp_object
                                    (call_exp_object
                                      (dot_exp_object
                                        (var_exp
                                          (identifier))
                                        (identifier))
                                      (par_exp
                                        (call_exp_object
                                          (dot_exp_object
                                            (var_exp
                                              (identifier))
                                            (identifier))
                                          (inst
                                            (path_typ
                                              (typ_path
                                                (type_identifier))))
                                          (par_exp
                                            (lit_exp
                                              (int_literal))
                                            (func_exp
                                              (wild_pat)
                                              (func_body
                                                (call_exp_object
                                                  (dot_exp_object
                                                    (var_exp
                                                      (identifier))
                                                    (identifier))
                                                  (par_exp))))))
                                        (dot_exp_object
                                          (var_exp
                                            (identifier))
                                          (identifier))
                                        (dot_exp_object
                                          (var_exp
                                            (identifier))
                                          (identifier))))
                                    (identifier))
                                  (par_exp
                                    (var_exp
                                      (identifier))))))))))))
                (exp_dec
                  (await_exp
                    (call_exp_block
                      (var_exp
                        (identifier))
                      (par_exp
                        (lit_exp
                          (text_literal))
                        (func_exp
                          (tup_pat)
                          (typ_annot
                            (async_typ
                              (tup_typ)))
                          (func_body
                            (block_exp
                              (let_dec
                                (var_pat
                                  (identifier))
                                (call_exp_object
                                  (dot_exp_object
                                    (var_exp
                                      (identifier))
                                    (identifier))
                                  (par_exp
                                    (lit_exp
                                      (int_literal)))))
                              (let_dec
                                (annot_pat
                                  (var_pat
                                    (identifier))
                                  (typ_annot
                                    (array_typ
                                      (path_typ
                                        (typ_path
                                          (type_identifier))))))
                                (array_exp
                                  (lit_exp
                                    (int_literal))
                                  (lit_exp
                                    (int_literal))
                                  (lit_exp
                                    (int_literal))
                                  (lit_exp
                                    (int_literal))
                                  (lit_exp
                                    (int_literal))
                                  (lit_exp
                                    (int_literal))
                                  (lit_exp
                                    (int_literal))
                                  (lit_exp
                                    (int_literal))
                                  (lit_exp
                                    (int_literal))
                                  (lit_exp
                                    (int_literal))))
                              (exp_dec
                                (call_exp_object
                                  (dot_exp_object
                                    (call_exp_object
                                      (dot_exp_object
                                        (var_exp
                                          (identifier))
                                        (identifier))
                                      (par_exp
                                        (call_exp_object
                                          (dot_exp_object
                                            (var_exp
                                              (identifier))
                                            (identifier))
                                          (inst
                                            (path_typ
                                              (typ_path
                                                (type_identifier))))
                                          (par_exp
                                            (lit_exp
                                              (int_literal))
                                            (func_exp
                                              (wild_pat)
                                              (func_body
                                                (call_exp_object
                                                  (dot_exp_object
                                                    (var_exp
                                                      (identifier))
                                                    (identifier))
                                                  (par_exp))))))
                                        (dot_exp_object
                                          (var_exp
                                            (identifier))
                                          (identifier))
                                        (dot_exp_object
                                          (var_exp
                                            (identifier))
                                          (identifier))))
                                    (identifier))
                                  (par_exp
                                    (var_exp
                                      (identifier))))))))))))
                (exp_dec
                  (await_exp
                    (call_exp_block
                      (var_exp
                        (identifier))
                      (par_exp
                        (lit_exp
                          (text_literal))
                        (func_exp
                          (tup_pat)
                          (typ_annot
                            (async_typ
                              (tup_typ)))
                          (func_body
                            (block_exp
                              (let_dec
                                (var_pat
                                  (identifier))
                                (call_exp_object
                                  (dot_exp_object
                                    (var_exp
                                      (identifier))
                                    (identifier))
                                  (par_exp
                                    (lit_exp
                                      (int_literal)))))
                              (let_dec
                                (annot_pat
                                  (var_pat
                                    (identifier))
                                  (typ_annot
                                    (array_typ
                                      (path_typ
                                        (typ_path
                                          (type_identifier))))))
                                (array_exp
                                  (lit_exp
                                    (int_literal))
                                  (lit_exp
                                    (int_literal))
                                  (lit_exp
                                    (int_literal))
                                  (lit_exp
                                    (int_literal))
                                  (lit_exp
                                    (int_literal))))
                              (exp_dec
                                (call_exp_object
                                  (dot_exp_object
                                    (call_exp_object
                                      (dot_exp_object
                                        (var_exp
                                          (identifier))
                                        (identifier))
                                      (par_exp
                                        (call_exp_object
                                          (dot_exp_object
                                            (var_exp
                                              (identifier))
                                            (identifier))
                                          (inst
                                            (path_typ
                                              (typ_path
                                                (type_identifier))))
                                          (par_exp
                                            (lit_exp
                                              (int_literal))
                                            (func_exp
                                              (wild_pat)
                                              (func_body
                                                (call_exp_object
                                                  (dot_exp_object
                                                    (var_exp
                                                      (identifier))
                                                    (identifier))
                                                  (par_exp))))))
                                        (dot_exp_object
                                          (var_exp
                                            (identifier))
                                          (identifier))
                                        (dot_exp_object
                                          (var_exp
                                            (identifier))
                                          (identifier))))
                                    (identifier))
                                  (par_exp
                                    (var_exp
                                      (identifier))))))))))))
                (exp_dec
                  (await_exp
                    (call_exp_block
                      (var_exp
                        (identifier))
                      (par_exp
                        (lit_exp
                          (text_literal))
                        (func_exp
                          (tup_pat)
                          (typ_annot
                            (async_typ
                              (tup_typ)))
                          (func_body
                            (block_exp
                              (let_dec
                                (var_pat
                                  (identifier))
                                (call_exp_object
                                  (dot_exp_object
                                    (var_exp
                                      (identifier))
                                    (identifier))
                                  (par_exp
                                    (lit_exp
                                      (int_literal)))))
                              (let_dec
                                (annot_pat
                                  (var_pat
                                    (identifier))
                                  (typ_annot
                                    (array_typ
                                      (path_typ
                                        (typ_path
                                          (type_identifier))))))
                                (array_exp
                                  (lit_exp
                                    (int_literal))
                                  (lit_exp
                                    (int_literal))
                                  (lit_exp
                                    (int_literal))
                                  (lit_exp
                                    (int_literal))
                                  (lit_exp
                                    (int_literal))))
                              (exp_dec
                                (call_exp_object
                                  (dot_exp_object
                                    (call_exp_object
                                      (dot_exp_object
                                        (var_exp
                                          (identifier))
                                        (identifier))
                                      (par_exp
                                        (call_exp_object
                                          (dot_exp_object
                                            (var_exp
                                              (identifier))
                                            (identifier))
                                          (inst
                                            (path_typ
                                              (typ_path
                                                (type_identifier))))
                                          (par_exp
                                            (lit_exp
                                              (int_literal))
                                            (func_exp
                                              (wild_pat)
                                              (func_body
                                                (call_exp_object
                                                  (dot_exp_object
                                                    (var_exp
                                                      (identifier))
                                                    (identifier))
                                                  (par_exp))))))
                                        (dot_exp_object
                                          (var_exp
                                            (identifier))
                                          (identifier))
                                        (dot_exp_object
                                          (var_exp
                                            (identifier))
                                          (identifier))))
                                    (identifier))
                                  (par_exp
                                    (var_exp
                                      (identifier))))))))))))
                (exp_dec
                  (await_exp
                    (call_exp_block
                      (var_exp
                        (identifier))
                      (par_exp
                        (lit_exp
                          (text_literal))
                        (func_exp
                          (tup_pat)
                          (typ_annot
                            (async_typ
                              (tup_typ)))
                          (func_body
                            (block_exp
                              (let_dec
                                (var_pat
                                  (identifier))
                                (call_exp_object
                                  (dot_exp_object
                                    (var_exp
                                      (identifier))
                                    (identifier))
                                  (par_exp
                                    (lit_exp
                                      (int_literal)))))
                              (let_dec
                                (var_pat
                                  (identifier))
                                (lit_exp
                                  (int_literal)))
                              (var_dec
                                (var_pat
                                  (identifier))
                                (lit_exp
                                  (int_literal)))
                              (exp_dec
                                (for_exp
                                  (wild_pat)
                                  (call_exp_object
                                    (dot_exp_object
                                      (var_exp
                                        (identifier))
                                      (identifier))
                                    (par_exp
                                      (lit_exp
                                        (int_literal))
                                      (var_exp
                                        (identifier))))
                                  (block_exp
                                    (exp_dec
                                      (binassign_exp_object
                                        (var_exp
                                          (identifier))
                                        (binassign_op)
                                        (call_exp_object
                                          (dot_exp_object
                                            (var_exp
                                              (identifier))
                                            (identifier))
                                          (par_exp
                                            (call_exp_object
                                              (dot_exp_object
                                                (var_exp
                                                  (identifier))
                                                (identifier))
                                              (par_exp)))))))))
                              (let_dec
                                (var_pat
                                  (identifier))
                                (bin_exp_object
                                  (var_exp
                                    (identifier))
                                  (bin_op)
                                  (var_exp
                                    (identifier))))
                              (let_dec
                                (var_pat
                                  (identifier))
                                (bin_exp_object
                                  (call_exp_object
                                    (dot_exp_object
                                      (var_exp
                                        (identifier))
                                      (identifier))
                                    (par_exp
                                      (dot_exp_object
                                        (var_exp
                                          (identifier))
                                        (identifier))))
                                  (bin_op)
                                  (lit_exp
                                    (int_literal))))
                              (exp_dec
                                (assert_exp
                                  (bin_exp_block
                                    (bin_exp_block
                                      (call_exp_block
                                        (dot_exp_block
                                          (var_exp
                                            (identifier))
                                          (identifier))
                                        (par_exp
                                          (annot_exp_object
                                            (bin_exp_object
                                              (var_exp
                                                (identifier))
                                              (bin_op)
                                              (var_exp
                                                (identifier)))
                                            (path_typ
                                              (typ_path
                                                (type_identifier))))))
                                      (rel_op)
                                      (var_exp
                                        (identifier)))
                                    (bin_op)
                                    (lit_exp
                                      (int_literal))))))))))))
                (exp_dec
                  (await_exp
                    (call_exp_block
                      (var_exp
                        (identifier))
                      (par_exp
                        (lit_exp
                          (text_literal))
                        (func_exp
                          (tup_pat)
                          (typ_annot
                            (async_typ
                              (tup_typ)))
                          (func_body
                            (block_exp
                              (let_dec
                                (var_pat
                                  (identifier))
                                (call_exp_object
                                  (dot_exp_object
                                    (var_exp
                                      (identifier))
                                    (identifier))
                                  (par_exp
                                    (lit_exp
                                      (int_literal)))))
                              (let_dec
                                (annot_pat
                                  (var_pat
                                    (identifier))
                                  (typ_annot
                                    (path_typ
                                      (typ_path
                                        (type_identifier)))))
                                (lit_exp
                                  (int_literal)))
                              (let_dec
                                (annot_pat
                                  (var_pat
                                    (identifier))
                                  (typ_annot
                                    (path_typ
                                      (typ_path
                                        (type_identifier)))))
                                (lit_exp
                                  (int_literal)))
                              (exp_dec
                                (for_exp
                                  (wild_pat)
                                  (call_exp_object
                                    (dot_exp_object
                                      (var_exp
                                        (identifier))
                                      (identifier))
                                    (par_exp
                                      (lit_exp
                                        (int_literal))
                                      (lit_exp
                                        (int_literal))))
                                  (block_exp
                                    (let_dec
                                      (var_pat
                                        (identifier))
                                      (call_exp_object
                                        (dot_exp_object
                                          (var_exp
                                            (identifier))
                                          (identifier))
                                        (par_exp
                                          (var_exp
                                            (identifier))
                                          (var_exp
                                            (identifier)))))
                                    (exp_dec
                                      (assert_exp
                                        (bin_exp_block
                                          (bin_exp_block
                                            (bin_exp_block
                                              (var_exp
                                                (identifier))
                                              (rel_op)
                                              (var_exp
                                                (identifier)))
                                            (bin_op)
                                            (var_exp
                                              (identifier)))
                                          (rel_op)
                                          (var_exp
                                            (identifier)))))))))))))))
                (exp_dec
                  (await_exp
                    (call_exp_block
                      (var_exp
                        (identifier))
                      (par_exp
                        (lit_exp
                          (text_literal))
                        (func_exp
                          (tup_pat)
                          (typ_annot
                            (async_typ
                              (tup_typ)))
                          (func_body
                            (block_exp
                              (let_dec
                                (var_pat
                                  (identifier))
                                (call_exp_object
                                  (dot_exp_object
                                    (var_exp
                                      (identifier))
                                    (identifier))
                                  (par_exp
                                    (lit_exp
                                      (int_literal)))))
                              (let_dec
                                (var_pat
                                  (identifier))
                                (lit_exp
                                  (int_literal)))
                              (let_dec
                                (var_pat
                                  (identifier))
                                (lit_exp
                                  (int_literal)))
                              (let_dec
                                (var_pat
                                  (identifier))
                                (lit_exp
                                  (int_literal)))
                              (var_dec
                                (var_pat
                                  (identifier))
                                (lit_exp
                                  (int_literal)))
                              (exp_dec
                                (for_exp
                                  (wild_pat)
                                  (call_exp_object
                                    (dot_exp_object
                                      (var_exp
                                        (identifier))
                                      (identifier))
                                    (par_exp
                                      (lit_exp
                                        (int_literal))
                                      (var_exp
                                        (identifier))))
                                  (block_exp
                                    (exp_dec
                                      (binassign_exp_object
                                        (var_exp
                                          (identifier))
                                        (binassign_op)
                                        (call_exp_object
                                          (dot_exp_object
                                            (var_exp
                                              (identifier))
                                            (identifier))
                                          (par_exp
                                            (var_exp
                                              (identifier))
                                            (var_exp
                                              (identifier)))))))))
                              (let_dec
                                (var_pat
                                  (identifier))
                                (bin_exp_object
                                  (var_exp
                                    (identifier))
                                  (bin_op)
                                  (var_exp
                                    (identifier))))
                              (let_dec
                                (var_pat
                                  (identifier))
                                (bin_exp_object
                                  (bin_exp_object
                                    (var_exp
                                      (identifier))
                                    (bin_op)
                                    (par_exp
                                      (annot_exp_object
                                        (bin_exp_object
                                          (var_exp
                                            (identifier))
                                          (bin_op)
                                          (var_exp
                                            (identifier)))
                                        (path_typ
                                          (typ_path
                                            (type_identifier))))))
                                  (bin_op)
                                  (lit_exp
                                    (int_literal))))
                              (exp_dec
                                (assert_exp
                                  (bin_exp_block
                                    (bin_exp_block
                                      (call_exp_block
                                        (dot_exp_block
                                          (var_exp
                                            (identifier))
                                          (identifier))
                                        (par_exp
                                          (annot_exp_object
                                            (bin_exp_object
                                              (var_exp
                                                (identifier))
                                              (bin_op)
                                              (var_exp
                                                (identifier)))
                                            (path_typ
                                              (typ_path
                                                (type_identifier))))))
                                      (rel_op)
                                      (par_exp
                                        (annot_exp_object
                                          (bin_exp_object
                                            (var_exp
                                              (identifier))
                                            (bin_op)
                                            (var_exp
                                              (identifier)))
                                          (path_typ
                                            (typ_path
                                              (type_identifier))))))
                                    (bin_op)
                                    (lit_exp
                                      (int_literal))))))))))))
                (exp_dec
                  (await_exp
                    (call_exp_block
                      (var_exp
                        (identifier))
                      (par_exp
                        (lit_exp
                          (text_literal))
                        (func_exp
                          (tup_pat)
                          (typ_annot
                            (async_typ
                              (tup_typ)))
                          (func_body
                            (block_exp
                              (let_dec
                                (var_pat
                                  (identifier))
                                (call_exp_object
                                  (dot_exp_object
                                    (var_exp
                                      (identifier))
                                    (identifier))
                                  (par_exp
                                    (lit_exp
                                      (int_literal)))))
                              (let_dec
                                (var_pat
                                  (identifier))
                                (lit_exp
                                  (int_literal)))
                              (let_dec
                                (var_pat
                                  (identifier))
                                (lit_exp
                                  (int_literal)))
                              (exp_dec
                                (for_exp
                                  (wild_pat)
                                  (call_exp_object
                                    (dot_exp_object
                                      (var_exp
                                        (identifier))
                                      (identifier))
                                    (par_exp
                                      (lit_exp
                                        (int_literal))
                                      (lit_exp
                                        (int_literal))))
                                  (block_exp
                                    (let_dec
                                      (var_pat
                                        (identifier))
                                      (call_exp_object
                                        (dot_exp_object
                                          (var_exp
                                            (identifier))
                                          (identifier))
                                        (par_exp
                                          (var_exp
                                            (identifier))
                                          (var_exp
                                            (identifier)))))
                                    (exp_dec
                                      (assert_exp
                                        (bin_exp_block
                                          (bin_exp_block
                                            (bin_exp_block
                                              (var_exp
                                                (identifier))
                                              (rel_op)
                                              (var_exp
                                                (identifier)))
                                            (bin_op)
                                            (var_exp
                                              (identifier)))
                                          (rel_op)
                                          (var_exp
                                            (identifier)))))))))))))))
                (exp_dec
                  (await_exp
                    (call_exp_block
                      (var_exp
                        (identifier))
                      (par_exp
                        (lit_exp
                          (text_literal))
                        (func_exp
                          (tup_pat)
                          (typ_annot
                            (async_typ
                              (tup_typ)))
                          (func_body
                            (block_exp
                              (let_dec
                                (var_pat
                                  (identifier))
                                (call_exp_object
                                  (dot_exp_object
                                    (var_exp
                                      (identifier))
                                    (identifier))
                                  (par_exp
                                    (lit_exp
                                      (int_literal)))))
                              (let_dec
                                (var_pat
                                  (identifier))
                                (lit_exp
                                  (int_literal)))
                              (let_dec
                                (var_pat
                                  (identifier))
                                (lit_exp
                                  (int_literal)))
                              (let_dec
                                (var_pat
                                  (identifier))
                                (lit_exp
                                  (int_literal)))
                              (var_dec
                                (var_pat
                                  (identifier))
                                (lit_exp
                                  (int_literal)))
                              (exp_dec
                                (for_exp
                                  (wild_pat)
                                  (call_exp_object
                                    (dot_exp_object
                                      (var_exp
                                        (identifier))
                                      (identifier))
                                    (par_exp
                                      (lit_exp
                                        (int_literal))
                                      (var_exp
                                        (identifier))))
                                  (block_exp
                                    (exp_dec
                                      (binassign_exp_object
                                        (var_exp
                                          (identifier))
                                        (binassign_op)
                                        (call_exp_object
                                          (dot_exp_object
                                            (var_exp
                                              (identifier))
                                            (identifier))
                                          (par_exp
                                            (var_exp
                                              (identifier))
                                            (var_exp
                                              (identifier)))))))))
                              (let_dec
                                (var_pat
                                  (identifier))
                                (bin_exp_object
                                  (var_exp
                                    (identifier))
                                  (bin_op)
                                  (var_exp
                                    (identifier))))
                              (let_dec
                                (var_pat
                                  (identifier))
                                (bin_exp_object
                                  (bin_exp_object
                                    (var_exp
                                      (identifier))
                                    (bin_op)
                                    (par_exp
                                      (bin_exp_object
                                        (var_exp
                                          (identifier))
                                        (bin_op)
                                        (var_exp
                                          (identifier)))))
                                  (bin_op)
                                  (lit_exp
                                    (int_literal))))
                              (exp_dec
                                (assert_exp
                                  (bin_exp_block
                                    (bin_exp_block
                                      (call_exp_block
                                        (dot_exp_block
                                          (var_exp
                                            (identifier))
                                          (identifier))
                                        (par_exp
                                          (bin_exp_object
                                            (var_exp
                                              (identifier))
                                            (bin_op)
                                            (var_exp
                                              (identifier)))))
                                      (rel_op)
                                      (par_exp
                                        (bin_exp_object
                                          (var_exp
                                            (identifier))
                                          (bin_op)
                                          (var_exp
                                            (identifier)))))
                                    (bin_op)
                                    (lit_exp
                                      (int_literal))))))))))))
                (exp_dec
                  (await_exp
                    (call_exp_block
                      (var_exp
                        (identifier))
                      (par_exp
                        (lit_exp
                          (text_literal))
                        (func_exp
                          (tup_pat)
                          (typ_annot
                            (async_typ
                              (tup_typ)))
                          (func_body
                            (block_exp
                              (let_dec
                                (var_pat
                                  (identifier))
                                (call_exp_object
                                  (dot_exp_object
                                    (var_exp
                                      (identifier))
                                    (identifier))
                                  (par_exp
                                    (lit_exp
                                      (int_literal)))))
                              (let_dec
                                (var_pat
                                  (identifier))
                                (lit_exp
                                  (int_literal)))
                              (let_dec
                                (var_pat
                                  (identifier))
                                (lit_exp
                                  (int_literal)))
                              (exp_dec
                                (for_exp
                                  (wild_pat)
                                  (call_exp_object
                                    (dot_exp_object
                                      (var_exp
                                        (identifier))
                                      (identifier))
                                    (par_exp
                                      (lit_exp
                                        (int_literal))
                                      (lit_exp
                                        (int_literal))))
                                  (block_exp
                                    (let_dec
                                      (var_pat
                                        (identifier))
                                      (call_exp_object
                                        (dot_exp_object
                                          (var_exp
                                            (identifier))
                                          (identifier))
                                        (par_exp
                                          (var_exp
                                            (identifier))
                                          (var_exp
                                            (identifier)))))
                                    (exp_dec
                                      (assert_exp
                                        (bin_exp_block
                                          (bin_exp_block
                                            (bin_exp_block
                                              (var_exp
                                                (identifier))
                                              (rel_op)
                                              (var_exp
                                                (identifier)))
                                            (bin_op)
                                            (var_exp
                                              (identifier)))
                                          (rel_op)
                                          (var_exp
                                            (identifier)))))))))))))))
                (exp_dec
                  (await_exp
                    (call_exp_block
                      (var_exp
                        (identifier))
                      (par_exp
                        (lit_exp
                          (text_literal))
                        (func_exp
                          (tup_pat)
                          (typ_annot
                            (async_typ
                              (tup_typ)))
                          (func_body
                            (block_exp
                              (let_dec
                                (var_pat
                                  (identifier))
                                (call_exp_object
                                  (dot_exp_object
                                    (var_exp
                                      (identifier))
                                    (identifier))
                                  (par_exp
                                    (lit_exp
                                      (int_literal)))))
                              (let_dec
                                (annot_pat
                                  (var_pat
                                    (identifier))
                                  (typ_annot
                                    (array_typ
                                      (func_typ
                                        (tup_typ
                                          (typ_item
                                            (path_typ
                                              (typ_path
                                                (type_identifier))))
                                          (typ_item
                                            (path_typ
                                              (typ_path
                                                (type_identifier)))))
                                        (path_typ
                                          (typ_path
                                            (type_identifier)))))))
                                (array_exp
                                  (func_exp
                                    (tup_pat
                                      (var_pat
                                        (identifier))
                                      (var_pat
                                        (identifier)))
                                    (func_body
                                      (call_exp_object
                                        (dot_exp_object
                                          (var_exp
                                            (identifier))
                                          (identifier))
                                        (par_exp
                                          (call_exp_object
                                            (dot_exp_object
                                              (var_exp
                                                (identifier))
                                              (identifier))
                                            (par_exp
                                              (call_exp_object
                                                (dot_exp_object
                                                  (var_exp
                                                    (identifier))
                                                  (identifier))
                                                (par_exp
                                                  (var_exp
                                                    (identifier))))
                                              (call_exp_object
                                                (dot_exp_object
                                                  (var_exp
                                                    (identifier))
                                                  (identifier))
                                                (par_exp
                                                  (var_exp
                                                    (identifier))))))))))
                                  (func_exp
                                    (tup_pat
                                      (var_pat
                                        (identifier))
                                      (var_pat
                                        (identifier)))
                                    (func_body
                                      (call_exp_object
                                        (dot_exp_object
                                          (var_exp
                                            (identifier))
                                          (identifier))
                                        (par_exp
                                          (call_exp_object
                                            (dot_exp_object
                                              (var_exp
                                                (identifier))
                                              (identifier))
                                            (par_exp
                                              (var_exp
                                                (identifier))
                                              (var_exp
                                                (identifier))))))))
                                  (dot_exp_object
                                    (var_exp
                                      (identifier))
                                    (identifier))))
                              (exp_dec
                                (for_exp
                                  (var_pat
                                    (identifier))
                                  (call_exp_object
                                    (dot_exp_object
                                      (var_exp
                                        (identifier))
                                      (identifier))
                                    (par_exp))
                                  (block_exp
                                    (line_comment)
                                    (exp_dec
                                      (for_exp
                                        (var_pat
                                          (identifier))
                                        (call_exp_object
                                          (dot_exp_object
                                            (var_exp
                                              (identifier))
                                            (identifier))
                                          (par_exp
                                            (lit_exp
                                              (int_literal))
                                            (lit_exp
                                              (int_literal))))
                                        (block_exp
                                          (exp_dec
                                            (assert_exp
                                              (bin_exp_block
                                                (call_exp_block
                                                  (var_exp
                                                    (identifier))
                                                  (par_exp
                                                    (var_exp
                                                      (identifier))
                                                    (bin_exp_object
                                                      (var_exp
                                                        (identifier))
                                                      (bin_op)
                                                      (lit_exp
                                                        (int_literal)))))
                                                (rel_op)
                                                (var_exp
                                                  (identifier))))))))
                                    (line_comment)
                                    (var_dec
                                      (var_pat
                                        (identifier))
                                      (lit_exp
                                        (int_literal)))
                                    (var_dec
                                      (var_pat
                                        (identifier))
                                      (lit_exp
                                        (int_literal)))
                                    (exp_dec
                                      (for_exp
                                        (var_pat
                                          (identifier))
                                        (call_exp_object
                                          (dot_exp_object
                                            (var_exp
                                              (identifier))
                                            (identifier))
                                          (par_exp
                                            (lit_exp
                                              (int_literal))
                                            (lit_exp
                                              (int_literal))))
                                        (block_exp
                                          (let_dec
                                            (var_pat
                                              (identifier))
                                            (call_exp_object
                                              (var_exp
                                                (identifier))
                                              (par_exp
                                                (var_exp
                                                  (identifier))
                                                (bin_exp_object
                                                  (var_exp
                                                    (identifier))
                                                  (bin_op)
                                                  (lit_exp
                                                    (int_literal))))))
                                          (exp_dec
                                            (if_exp
                                              (par_exp
                                                (bin_exp_object
                                                  (var_exp
                                                    (identifier))
                                                  (rel_op)
                                                  (var_exp
                                                    (identifier))))
                                              (block_exp
                                                (exp_dec
                                                  (binassign_exp_object
                                                    (var_exp
                                                      (identifier))
                                                    (binassign_op)
                                                    (lit_exp
                                                      (int_literal)))))
                                              (if_exp
                                                (par_exp
                                                  (bin_exp_object
                                                    (bin_exp_object
                                                      (var_exp
                                                        (identifier))
                                                      (rel_op)
                                                      (var_exp
                                                        (identifier)))
                                                    (bin_op)
                                                    (lit_exp
                                                      (int_literal))))
                                                (block_exp
                                                  (exp_dec
                                                    (binassign_exp_object
                                                      (var_exp
                                                        (identifier))
                                                      (binassign_op)
                                                      (lit_exp
                                                        (int_literal)))))
                                                (block_exp
                                                  (exp_dec
                                                    (assert_exp
                                                      (lit_exp
                                                        (bool_literal)))))))))))
                                    (exp_dec
                                      (assert_exp
                                        (bin_exp_block
                                          (var_exp
                                            (identifier))
                                          (rel_op)
                                          (lit_exp
                                            (int_literal)))))
                                    (exp_dec
                                      (assert_exp
                                        (bin_exp_block
                                          (var_exp
                                            (identifier))
                                          (rel_op)
                                          (lit_exp
                                            (int_literal)))))
                                    (line_comment)
                                    (exp_dec
                                      (assign_exp_object
                                        (var_exp
                                          (identifier))
                                        (lit_exp
                                          (int_literal))))
                                    (exp_dec
                                      (assign_exp_object
                                        (var_exp
                                          (identifier))
                                        (lit_exp
                                          (int_literal))))
                                    (var_dec
                                      (var_pat
                                        (identifier))
                                      (lit_exp
                                        (int_literal)))
                                    (exp_dec
                                      (for_exp
                                        (var_pat
                                          (identifier))
                                        (call_exp_object
                                          (dot_exp_object
                                            (var_exp
                                              (identifier))
                                            (identifier))
                                          (par_exp
                                            (lit_exp
                                              (int_literal))
                                            (lit_exp
                                              (int_literal))))
                                        (block_exp
                                          (let_dec
                                            (var_pat
                                              (identifier))
                                            (call_exp_object
                                              (var_exp
                                                (identifier))
                                              (par_exp
                                                (var_exp
                                                  (identifier))
                                                (bin_exp_object
                                                  (var_exp
                                                    (identifier))
                                                  (bin_op)
                                                  (lit_exp
                                                    (int_literal))))))
                                          (exp_dec
                                            (if_exp
                                              (par_exp
                                                (bin_exp_object
                                                  (var_exp
                                                    (identifier))
                                                  (rel_op)
                                                  (var_exp
                                                    (identifier))))
                                              (block_exp
                                                (exp_dec
                                                  (binassign_exp_object
                                                    (var_exp
                                                      (identifier))
                                                    (binassign_op)
                                                    (lit_exp
                                                      (int_literal)))))
                                              (if_exp
                                                (par_exp
                                                  (bin_exp_object
                                                    (bin_exp_object
                                                      (var_exp
                                                        (identifier))
                                                      (rel_op)
                                                      (var_exp
                                                        (identifier)))
                                                    (bin_op)
                                                    (lit_exp
                                                      (int_literal))))
                                                (block_exp
                                                  (exp_dec
                                                    (binassign_exp_object
                                                      (var_exp
                                                        (identifier))
                                                      (binassign_op)
                                                      (lit_exp
                                                        (int_literal)))))
                                                (if_exp
                                                  (par_exp
                                                    (bin_exp_object
                                                      (bin_exp_object
                                                        (var_exp
                                                          (identifier))
                                                        (rel_op)
                                                        (var_exp
                                                          (identifier)))
                                                      (bin_op)
                                                      (lit_exp
                                                        (int_literal))))
                                                  (block_exp
                                                    (exp_dec
                                                      (binassign_exp_object
                                                        (var_exp
                                                          (identifier))
                                                        (binassign_op)
                                                        (lit_exp
                                                          (int_literal)))))
                                                  (block_exp
                                                    (exp_dec
                                                      (assert_exp
                                                        (lit_exp
                                                          (bool_literal))))))))))))
                                    (exp_dec
                                      (assert_exp
                                        (bin_exp_block
                                          (var_exp
                                            (identifier))
                                          (rel_op)
                                          (lit_exp
                                            (int_literal)))))
                                    (exp_dec
                                      (assert_exp
                                        (bin_exp_block
                                          (var_exp
                                            (identifier))
                                          (rel_op)
                                          (lit_exp
                                            (int_literal)))))
                                    (exp_dec
                                      (assert_exp
                                        (bin_exp_block
                                          (var_exp
                                            (identifier))
                                          (rel_op)
                                          (lit_exp
                                            (int_literal))))))))))))))))))))))
  (exp_dec
    (await_exp
      (call_exp_block
        (var_exp
          (identifier))
        (par_exp
          (lit_exp
            (text_literal))
          (func_exp
            (tup_pat)
            (typ_annot
              (async_typ
                (tup_typ)))
            (func_body
              (block_exp
                (exp_dec
                  (await_exp
                    (call_exp_block
                      (var_exp
                        (identifier))
                      (par_exp
                        (lit_exp
                          (text_literal))
                        (func_exp
                          (tup_pat)
                          (typ_annot
                            (async_typ
                              (tup_typ)))
                          (func_body
                            (block_exp
                              (let_dec
                                (var_pat
                                  (identifier))
                                (call_exp_object
                                  (dot_exp_object
                                    (var_exp
                                      (identifier))
                                    (identifier))
                                  (par_exp
                                    (lit_exp
                                      (int_literal)))))
                              (let_dec
                                (annot_pat
                                  (var_pat
                                    (identifier))
                                  (typ_annot
                                    (path_typ
                                      (typ_path
                                        (type_identifier)))))
                                (lit_exp
                                  (int_literal)))
                              (let_dec
                                (annot_pat
                                  (var_pat
                                    (identifier))
                                  (typ_annot
                                    (path_typ
                                      (typ_path
                                        (type_identifier)))))
                                (lit_exp
                                  (int_literal)))
                              (exp_dec
                                (for_exp
                                  (wild_pat)
                                  (call_exp_object
                                    (dot_exp_object
                                      (var_exp
                                        (identifier))
                                      (identifier))
                                    (par_exp
                                      (lit_exp
                                        (int_literal))
                                      (lit_exp
                                        (int_literal))))
                                  (block_exp
                                    (let_dec
                                      (var_pat
                                        (identifier))
                                      (call_exp_object
                                        (dot_exp_object
                                          (var_exp
                                            (identifier))
                                          (identifier))
                                        (par_exp
                                          (var_exp
                                            (identifier))
                                          (var_exp
                                            (identifier)))))
                                    (exp_dec
                                      (assert_exp
                                        (bin_exp_block
                                          (bin_exp_block
                                            (bin_exp_block
                                              (var_exp
                                                (identifier))
                                              (rel_op)
                                              (var_exp
                                                (identifier)))
                                            (bin_op)
                                            (var_exp
                                              (identifier)))
                                          (rel_op)
                                          (var_exp
                                            (identifier)))))))))))))))
                (exp_dec
                  (await_exp
                    (call_exp_block
                      (var_exp
                        (identifier))
                      (par_exp
                        (lit_exp
                          (text_literal))
                        (func_exp
                          (tup_pat)
                          (typ_annot
                            (async_typ
                              (tup_typ)))
                          (func_body
                            (block_exp
                              (let_dec
                                (var_pat
                                  (identifier))
                                (call_exp_object
                                  (dot_exp_object
                                    (var_exp
                                      (identifier))
                                    (identifier))
                                  (par_exp
                                    (lit_exp
                                      (int_literal)))))
                              (let_dec
                                (var_pat
                                  (identifier))
                                (lit_exp
                                  (int_literal)))
                              (let_dec
                                (var_pat
                                  (identifier))
                                (lit_exp
                                  (int_literal)))
                              (exp_dec
                                (for_exp
                                  (wild_pat)
                                  (call_exp_object
                                    (dot_exp_object
                                      (var_exp
                                        (identifier))
                                      (identifier))
                                    (par_exp
                                      (lit_exp
                                        (int_literal))
                                      (lit_exp
                                        (int_literal))))
                                  (block_exp
                                    (let_dec
                                      (var_pat
                                        (identifier))
                                      (call_exp_object
                                        (dot_exp_object
                                          (var_exp
                                            (identifier))
                                          (identifier))
                                        (par_exp
                                          (var_exp
                                            (identifier))
                                          (var_exp
                                            (identifier)))))
                                    (exp_dec
                                      (assert_exp
                                        (bin_exp_block
                                          (bin_exp_block
                                            (bin_exp_block
                                              (var_exp
                                                (identifier))
                                              (rel_op)
                                              (var_exp
                                                (identifier)))
                                            (bin_op)
                                            (var_exp
                                              (identifier)))
                                          (rel_op)
                                          (var_exp
                                            (identifier)))))))))))))))
                (exp_dec
                  (await_exp
                    (call_exp_block
                      (var_exp
                        (identifier))
                      (par_exp
                        (lit_exp
                          (text_literal))
                        (func_exp
                          (tup_pat)
                          (typ_annot
                            (async_typ
                              (tup_typ)))
                          (func_body
                            (block_exp
                              (let_dec
                                (var_pat
                                  (identifier))
                                (call_exp_object
                                  (dot_exp_object
                                    (var_exp
                                      (identifier))
                                    (identifier))
                                  (par_exp
                                    (lit_exp
                                      (int_literal)))))
                              (let_dec
                                (var_pat
                                  (identifier))
                                (lit_exp
                                  (int_literal)))
                              (let_dec
                                (var_pat
                                  (identifier))
                                (lit_exp
                                  (int_literal)))
                              (exp_dec
                                (for_exp
                                  (wild_pat)
                                  (call_exp_object
                                    (dot_exp_object
                                      (var_exp
                                        (identifier))
                                      (identifier))
                                    (par_exp
                                      (lit_exp
                                        (int_literal))
                                      (lit_exp
                                        (int_literal))))
                                  (block_exp
                                    (let_dec
                                      (var_pat
                                        (identifier))
                                      (call_exp_object
                                        (dot_exp_object
                                          (var_exp
                                            (identifier))
                                          (identifier))
                                        (par_exp
                                          (var_exp
                                            (identifier))
                                          (var_exp
                                            (identifier)))))
                                    (exp_dec
                                      (assert_exp
                                        (bin_exp_block
                                          (bin_exp_block
                                            (bin_exp_block
                                              (var_exp
                                                (identifier))
                                              (rel_op)
                                              (var_exp
                                                (identifier)))
                                            (bin_op)
                                            (var_exp
                                              (identifier)))
                                          (rel_op)
                                          (var_exp
                                            (identifier)))))))))))))))))))))))
